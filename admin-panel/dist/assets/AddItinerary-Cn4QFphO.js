import{o as I,e as b,r as c,j as e,C as d,B as f,Q as C,n as l}from"./index-DeE3vtCn.js";import{j as k,g as w,c as G,q,r as L,s as T}from"./api-BHjxf7no.js";import{F as a}from"./Form-BuK-_8iF.js";import"./ElementChildren-DI3yop4o.js";import"./Col-BDLpqSzm.js";const F=()=>{const{id:o}=I(),p=b(),[r,u]=c.useState({package:"",hotel:"",transport:"",additionalServices:"",startDate:"",endDate:"",price:"",availability:!0}),[x,j]=c.useState([]),[m,y]=c.useState([]),[v,g]=c.useState([]);c.useEffect(()=>{(async()=>{try{const n=await k(),s=await w(),h=await G();j(n),y(s),g(h)}catch{l.error("Failed to load dropdown data.")}})(),o&&(async()=>{try{const s=await q(o);u({...s,additionalServices:s.additionalServices.join(", ")})}catch{l.error("Failed to load itinerary.")}})()},[o]);const i=t=>{const{name:n,value:s,type:h,checked:D}=t.target;u(h==="checkbox"?{...r,[n]:D}:{...r,[n]:s})},S=async t=>{t.preventDefault();const n={...r,additionalServices:r.additionalServices.split(",").map(s=>s.trim())};try{o?(await L(o,n),l.success("Itinerary updated successfully!")):(await T(n),l.success("Itinerary added successfully!")),setTimeout(()=>p("/itineraries"),2e3)}catch{l.error("Failed to save itinerary.")}};return e.jsxs(d,{children:[e.jsx(d.Header,{children:e.jsxs(d.Title,{as:"h5",children:[o?"Edit":"Add"," Itinerary"]})}),e.jsx(d.Body,{children:e.jsxs(a,{onSubmit:S,children:[e.jsxs(a.Group,{controlId:"packageId",children:[e.jsx(a.Label,{children:"Package"}),e.jsxs(a.Select,{name:"package",value:r.package,onChange:i,required:!0,children:[e.jsx("option",{value:"",children:"Select Package"}),x.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsxs(a.Group,{controlId:"hotel",children:[e.jsx(a.Label,{children:"Hotel"}),e.jsxs(a.Select,{name:"hotel",value:r.hotel,onChange:i,required:!0,children:[e.jsx("option",{value:"",children:"Select Hotel"}),m.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsxs(a.Group,{controlId:"transport",children:[e.jsx(a.Label,{children:"Transport"}),e.jsxs(a.Select,{name:"transport",value:r.transport,onChange:i,required:!0,children:[e.jsx("option",{value:"",children:"Select Transport"}),v.map(t=>e.jsx("option",{value:t._id,children:t.vehicleType},t._id))]})]}),e.jsxs(a.Group,{controlId:"additionalServices",children:[e.jsx(a.Label,{children:"Additional Services (comma separated)"}),e.jsx(a.Control,{type:"text",name:"additionalServices",value:r.additionalServices,onChange:i})]}),e.jsxs(a.Group,{controlId:"startDate",children:[e.jsx(a.Label,{children:"Start Date"}),e.jsx(a.Control,{type:"date",name:"startDate",value:r.startDate,onChange:i,required:!0})]}),e.jsxs(a.Group,{controlId:"endDate",children:[e.jsx(a.Label,{children:"End Date"}),e.jsx(a.Control,{type:"date",name:"endDate",value:r.endDate,onChange:i,required:!0})]}),e.jsxs(a.Group,{controlId:"price",children:[e.jsx(a.Label,{children:"Price"}),e.jsx(a.Control,{type:"number",name:"price",value:r.price,onChange:i,required:!0})]}),e.jsx(a.Group,{controlId:"availability",children:e.jsx(a.Check,{type:"checkbox",name:"availability",checked:r.availability,onChange:i,label:"Available"})}),e.jsxs(f,{className:"my-3",type:"submit",children:[o?"Update":"Add"," Itinerary"]})]})}),e.jsx(C,{})]})};export{F as default};
