import{o as C,e as f,r as p,j as e,C as m,B as u,Q as L,n as h}from"./index-DeE3vtCn.js";import{b as H,u as I}from"./api-BHjxf7no.js";import{F as t}from"./Form-BuK-_8iF.js";import"./ElementChildren-DI3yop4o.js";import"./Col-BDLpqSzm.js";const E=()=>{const{id:d}=C(),j=f(),[a,l]=p.useState({name:"",location:"",contact:"",amenities:[],rooms:[{roomType:"",rate:""}],contractRates:{agentRate:"",corporateRate:""},availability:!0}),[R,x]=p.useState(!0);p.useEffect(()=>{(async()=>{var s,o;try{const r=await H(d);l({name:r.data.name||"",location:r.data.location||"",contact:r.data.contact||"",amenities:r.data.amenities||[],rooms:r.data.rooms||[{roomType:"",rate:""}],contractRates:{agentRate:((s=r.data.contractRates)==null?void 0:s.agentRate)||"",corporateRate:((o=r.data.contractRates)==null?void 0:o.corporateRate)||""},availability:r.data.availability!==void 0?r.data.availability:!0}),x(!1)}catch{h.error("Failed to fetch hotel details."),x(!1)}})()},[d]);const i=(n,s=null)=>{const{name:o,value:r}=n.target;if(o.startsWith("roomType")||o.startsWith("rate")){const c=[...a.rooms];c[s][o]=r,l({...a,rooms:c})}else if(o==="amenities"){const c=r.split(",").map(b=>b.trim());l({...a,[o]:c})}else l(o==="agentRate"||o==="corporateRate"?{...a,contractRates:{...a.contractRates,[o]:r}}:{...a,[o]:r})},y=()=>{l({...a,rooms:[...a.rooms,{roomType:"",rate:""}]})},g=n=>{const s=a.rooms.filter((o,r)=>r!==n);l({...a,rooms:s})},v=async n=>{n.preventDefault();const s={...a,contractRates:{agentRate:a.contractRates.agentRate,corporateRate:a.contractRates.corporateRate}};try{(await I(d,s)).status===200&&(h.success("Hotel updated successfully!",{position:"top-right",autoClose:2e3}),setTimeout(()=>{j("/hotels")},2e3))}catch(o){h.error(`Error updating hotel: ${o.response?o.response.data.message:o.message}`,{position:"top-right",autoClose:3e3})}};return R?e.jsx("div",{children:"Loading..."}):e.jsxs(m,{children:[e.jsx(m.Header,{children:e.jsx(m.Title,{as:"h5",children:"Edit Hotel"})}),e.jsxs(m.Body,{children:[e.jsxs(t,{onSubmit:v,children:[e.jsxs(t.Group,{controlId:"hotelName",children:[e.jsx(t.Label,{children:"Hotel Name"}),e.jsx(t.Control,{type:"text",name:"name",value:a.name,onChange:i,required:!0})]}),e.jsxs(t.Group,{controlId:"hotelLocation",children:[e.jsx(t.Label,{children:"Location"}),e.jsx(t.Control,{type:"text",name:"location",value:a.location,onChange:i,required:!0})]}),e.jsxs(t.Group,{controlId:"hotelContact",children:[e.jsx(t.Label,{children:"Contact"}),e.jsx(t.Control,{type:"text",name:"contact",value:a.contact,onChange:i})]}),e.jsxs(t.Group,{controlId:"hotelAmenities",children:[e.jsx(t.Label,{children:"Amenities (comma-separated)"}),e.jsx(t.Control,{type:"text",name:"amenities",value:a.amenities.join(", "),onChange:i})]}),a.rooms.map((n,s)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(t.Group,{controlId:`roomType-${s}`,children:[e.jsx(t.Label,{children:"Room Type"}),e.jsx(t.Control,{type:"text",name:"roomType",value:n.roomType,onChange:o=>i(o,s),required:!0})]}),e.jsxs(t.Group,{controlId:`rate-${s}`,children:[e.jsx(t.Label,{children:"Rate"}),e.jsx(t.Control,{type:"number",name:"rate",value:n.rate,onChange:o=>i(o,s),required:!0})]}),s>0&&e.jsx(u,{className:"d-inline-flex my-3",variant:"danger",onClick:()=>g(s),children:"Remove Room"})]},s)),e.jsx(u,{variant:"secondary",onClick:y,children:"Add Another Room"}),e.jsxs(t.Group,{controlId:"agentRate",className:"mt-3",children:[e.jsx(t.Label,{children:"Agent Rate"}),e.jsx(t.Control,{type:"number",name:"agentRate",value:a.contractRates.agentRate,onChange:i,required:!0})]}),e.jsxs(t.Group,{controlId:"corporateRate",children:[e.jsx(t.Label,{children:"Corporate Rate"}),e.jsx(t.Control,{type:"number",name:"corporateRate",value:a.contractRates.corporateRate,onChange:i,required:!0})]}),e.jsxs(t.Group,{controlId:"hotelAvailability",children:[e.jsx(t.Label,{children:"Availability"}),e.jsx(t.Check,{type:"checkbox",name:"availability",label:"Available",checked:a.availability,onChange:()=>l({...a,availability:!a.availability})})]}),e.jsx(u,{variant:"primary",type:"submit",className:"mt-3",children:"Update Hotel"})]}),e.jsx(L,{})]})]})};export{E as default};
